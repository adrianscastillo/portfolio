import"./clean-urls.js_v_1-CVe7kFPS-Cihuvrqv.js";import"./cursor.js_v_1.2-D1XcpVVk-BTCTLylQ.js";class t{constructor(){this.boxes=Array.from(document.querySelectorAll(".draggable-box")),this.boxes.length&&(this.container=document.querySelector(".projects-container"),this.tooltip=document.getElementById("tooltip"),this.scatterButton=document.querySelector(".scatter"),this.scatterButton?this.bindScatterButton():setTimeout(()=>{this.scatterButton=document.querySelector(".scatter"),this.scatterButton&&this.bindScatterButton()},100),this.projectData=[{title:"DX10",heroImage:"/assets/images/dx10 cover-CMCuynen.jpg"},{title:"Terb",heroImage:"/assets/images/terb cover-h_QUVJyr.gif"},{title:"National Media Office",heroImage:"/assets/images/nmo cover-C14L-Tp_.jpg"},{title:"The Founders Office",heroImage:"/assets/images/tfo cover-BIASUizX.jpg"},{title:"Sheikh Zayed",heroImage:"/assets/images/zayed cover-D8pDKJav.jpg"},{title:"Kojinn",heroImage:"/assets/images/kojinn cover-CN2NiazX.jpg"},{title:"Hotaling & Co.",heroImage:"/assets/images/hc cover-Csbse1z4.gif"},{title:"Farm Sanctuary",heroImage:"/assets/images/fs cover-6t3d6SLl.jpg"},{title:"Relief International",heroImage:"/assets/images/ri-cover-BwIK5Nl6.jpg"}],this.draggedBox=null,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.highestZIndex=1e3,this.tooltipsEnabled=!1,this.init(),this.setBoxSizes())}init(){this.container&&this.bindEvents()}bindEvents(){this.boxes.forEach(t=>{t.addEventListener("mousedown",e=>this.startDrag(e,t)),t.addEventListener("mouseenter",e=>this.showTooltip(e,t)),t.addEventListener("mouseleave",()=>this.hideTooltip()),t.addEventListener("mousemove",t=>this.updateTooltipPosition(t))}),document.addEventListener("mousemove",t=>this.drag(t)),document.addEventListener("mouseup",t=>this.stopDrag(t)),document.addEventListener("wheel",t=>this.handleScroll(t),{passive:!1}),window.addEventListener("resize",()=>this.setBoxSizes())}bindScatterButton(){this.scatterButton&&this.scatterButton.addEventListener("click",t=>{t.preventDefault(),this.boxes.some((t,e)=>{if(9===e)return!1;const s=t.style.transform||"",o=s.includes("scale(0.7)"),i=s.includes("rotate("),n=!(t.style.left||"").includes("80vw");return o||i||n})?this.putBackBoxes():this.scatterBoxes()})}handleBoxClick(t,e){const s=Array.from(this.boxes).indexOf(e),o=e.style.transform;e.style.transform=o,setTimeout(()=>{window.location.href=`/work#project-${s}`},50)}showTooltip(t,e){if(!this.tooltip||!this.tooltipsEnabled)return;const s=Array.from(this.boxes).indexOf(e),o=this.projectData[s]||{title:`Project ${s+1}`};this.tooltip.textContent=o.title,this.tooltip.classList.add("visible"),this.updateTooltipPosition(t)}hideTooltip(){this.tooltip&&this.tooltip.classList.remove("visible")}updateTooltipPosition(t){if(!this.tooltip)return;const e=this.tooltip.getBoundingClientRect();let s=t.clientX-e.width/2,o=t.clientY+5;s<0?s=0:s+e.width>window.innerWidth&&(s=window.innerWidth-e.width),o+e.height>window.innerHeight&&(o=t.clientY-e.height-5),this.tooltip.style.left=`${s}px`,this.tooltip.style.top=`${o}px`}startDrag(t,e){t.preventDefault(),t.stopPropagation(),this.isDragging=!0,this.draggedBox=e,this.mouseStartX=t.clientX,this.mouseStartY=t.clientY,e.style.cursor="grabbing",this.highestZIndex+=1,e.style.zIndex=this.highestZIndex.toString(),e.classList.add("dragging"),this.mouseStartX=t.clientX,this.mouseStartY=t.clientY;const s=e.getBoundingClientRect();this.boxStartX=t.clientX-s.left,this.boxStartY=t.clientY-s.top}drag(t){if(!this.isDragging||!this.draggedBox)return;t.preventDefault(),t.stopPropagation();const e=this.container?this.container.scrollTop:0,s=t.clientX-this.boxStartX,o=t.clientY-this.boxStartY+e,i=this.draggedBox.style.transform,n=i.match(/rotate\(([^)]+)deg\)/),r=i.match(/scale\(([^)]+)\)/),a=n?n[1]:"0",l=r?r[1]:"1";if(parseFloat(l)<1){const e=t.clientX/window.innerWidth*100;this.draggedBox.style.left=`${e}vw`,this.draggedBox.style.top=`${o}px`,this.draggedBox.style.transform=`translateX(-50%) rotate(${a}deg) scale(${l})`}else this.draggedBox.style.left=`${s}px`,this.draggedBox.style.top=`${o}px`,this.draggedBox.style.transform=`rotate(${a}deg) scale(${l})`}stopDrag(t){this.isDragging&&this.draggedBox&&(Math.abs(t.clientX-this.mouseStartX)>5||Math.abs(t.clientY-this.mouseStartY)>5?this.updateButtonText():this.handleBoxClick(t,this.draggedBox),this.isDragging=!1,this.draggedBox.style.cursor="grab",this.draggedBox.classList.remove("dragging"),this.draggedBox=null)}handleScroll(t){this.isDragging||t.clientX>=.6*window.innerWidth&&this.container&&(t.preventDefault(),this.container.scrollTop+=t.deltaY)}setBoxSizes(){const t=.4*window.innerWidth*.6,e=Math.max(200,Math.min(400,t)),s=[];let o=0;const i=this.boxes.filter((t,e)=>9!==e).length;this.boxes.forEach((t,n)=>{if(9===n)return void(t.style.display="none");t.textContent="";const r=this.projectData[n];if(r&&r.heroImage){t.style.backgroundImage=`url('${r.heroImage}')`,t.style.backgroundSize="contain",t.style.backgroundRepeat="no-repeat",t.style.backgroundPosition="center";const a=new Image;a.onload=()=>{const t=a.width/a.height;let r,l;r=e,l=e/t,s[n]={width:r,height:l},o++,o===i&&this.positionBoxesInOrder(s)},a.onerror=()=>{t.style.backgroundImage=`url('${r.heroImage}')`,s[n]={width:e,height:e},o++,o===i&&this.positionBoxesInOrder(s)},a.src=r.heroImage}else s[n]={width:e,height:e},o++,o===i&&this.positionBoxesInOrder(s)})}positionBoxesInOrder(t){let e=100;this.boxes.forEach((s,o)=>{if(9===o)return;const i=t[o];i&&(s.style.width=`${i.width}px`,s.style.height=`${i.height}px`,s.style.left="80vw",s.style.top=`${e}px`,s.style.transform="translateX(-50%)",e+=i.height+12)}),this.updateButtonText(),setTimeout(()=>{this.boxes.some((t,e)=>{if(9===e)return!1;const s=t.style.transform||"",o=s.includes("scale(0.7)"),i=s.includes("rotate("),n=!(t.style.left||"").includes("80vw");return o||i||n})&&this.putBackBoxes()},100)}scatterBoxes(){0!==this.boxes.length&&(this.scatterButton&&(this.scatterButton.style.zIndex="9999"),this.boxes.forEach((t,e)=>{if(9===e)return;t.style.transition="none";const s=parseInt(t.style.top)||0;let o=null,i=null;this.boxes.forEach((t,n)=>{if(n!==e){const e=parseInt(t.style.top)||0;e<s&&(!o||e>parseInt(o.style.top))&&(o=t),e>s&&(!i||e<parseInt(i.style.top))&&(i=t)}}),parseInt(t.style.width);const n=parseInt(t.style.height)||220,r=window.innerHeight-n-20;let a,l,h=0;do{a=90*Math.random()+5,l=Math.random()*(r-20)+20,h++;const t=80,e=t*t;if(o){const t=a-(parseFloat(o.style.left)||80),s=l-(parseInt(o.style.top)||0);if(t*t+s*s<e)continue}if(i){const t=a-(parseFloat(i.style.left)||80),s=l-(parseInt(i.style.top)||0);if(t*t+s*s<e)continue}break}while(h<100);const d=(10*Math.random()-5).toFixed(1),c=this.boxes.length-e+1e3;t.style.zIndex=c.toString(),t.style.left=`${a}vw`,t.style.top=`${l}px`,t.style.transform=`translateX(-50%) rotate(${d}deg) scale(0.7)`}),this.updateButtonText())}updateButtonText(){if(this.scatterButton){const t=this.boxes.some((t,e)=>{if(9===e)return!1;const s=t.style.transform||"",o=s.includes("scale(0.7)"),i=s.includes("rotate("),n=!(t.style.left||"").includes("80vw");return o||i||n});this.scatterButton.textContent=t?"Clean up":"Scatter"}}putBackBoxes(){let t=100;this.boxes.forEach((e,s)=>{if(9===s)return;e.style.transition="none";const o=parseInt(e.style.height)||220,i=t;t+=o+12,e.style.left="80vw",e.style.top=`${i}px`,e.style.transform="translateX(-50%) scale(1)",e.style.zIndex=""}),this.updateButtonText()}enableTooltips(){this.tooltipsEnabled=!0}destroy(){document.removeEventListener("mousemove",this.drag),document.removeEventListener("mouseup",this.stopDrag),document.removeEventListener("wheel",this.handleScroll)}}function e(){try{if(!document.querySelector(".projects-container"))return void setTimeout(e,100);if(0===document.querySelectorAll(".draggable-box").length)return void setTimeout(e,100);document.querySelector(".scatter"),window.draggableBoxes=new t}catch(s){setTimeout(()=>{try{window.draggableBoxes=new t}catch(e){}},200)}}function s(){let t=0;!function s(){t++;try{if(e(),window.draggableBoxes)return}catch(o){}t<5&&setTimeout(s,150*t)}()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s(),setTimeout(()=>{window.draggableBoxes||s()},1e3);
